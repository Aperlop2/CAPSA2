<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rese√±as Enviadas</title>
    <link rel="stylesheet" href="rese√±as_guardadas.css">
</head>

<body>
    <div class="container">
        <h1 class="titulo">Rese√±as Enviadas</h1>

        <div id="mostrarRese√±as">
            <!-- Aqu√≠ se mostrar√°n todas las rese√±as -->
        </div>

        <!-- Bot√≥n para regresar -->
        <button id="regresarButton" onclick="window.history.back()">Regresar</button>
    </div>

    <script>
        // Obtener todas las rese√±as guardadas desde localStorage
        const rese√±as = JSON.parse(localStorage.getItem('rese√±as')) || [];
        const mostrarRese√±as = document.getElementById('mostrarRese√±as');

        // Colores para las estrellas seg√∫n la calificaci√≥n
        const coloresEstrellas = ['#ff0000', '#ffa500', '#ffff00', '#008000', '#0000ff'];

        // Funci√≥n para mostrar las rese√±as
        function mostrar() {
            mostrarRese√±as.innerHTML = ''; // Limpiar contenido actual

            if (rese√±as.length > 0) {
                rese√±as.forEach((rese√±a, index) => {
                    // Crear las estrellas con los colores correspondientes
                    const estrellasHTML = Array(5).fill('<span class="estrella">‚òÖ</span>').map((estrella, index) => {
                        return index < rese√±a.calificacion ?
                            `<span class="estrella" style="color: ${coloresEstrellas[index]}">‚òÖ</span>` : estrella;
                    }).join('');

                    const rese√±aHTML = `
                        <div class="rese√±a" id="rese√±a-${index}">
                            <strong>Servicio:</strong> ${rese√±a.servicio} <br>
                            <strong>Calificaci√≥n:</strong> ${estrellasHTML} <br>
                            <strong>Comentario:</strong> ${rese√±a.comentario} <br>
                            <button onclick="editarRese√±a(${index})">üñâ Editar</button>
                            <button onclick="borrarRese√±a(${index})">üóë Borrar</button>
                        </div>
                    `;
                    mostrarRese√±as.innerHTML += rese√±aHTML;
                });
            } else {
                mostrarRese√±as.innerHTML = '<p>No hay rese√±as para mostrar.</p>';
            }
        }

        // Llamar a la funci√≥n para mostrar las rese√±as al cargar la p√°gina
        mostrar();

        // Funci√≥n para editar una rese√±a
        function editarRese√±a(index) {
            const rese√±a = rese√±as[index];
            // Crear un formulario con todos los campos de la rese√±a
            const servicio = prompt('Editar servicio:', rese√±a.servicio);
            const calificacion = prompt('Editar calificaci√≥n (1-5):', rese√±a.calificacion);
            const comentario = prompt('Editar comentario:', rese√±a.comentario);

            if (servicio !== null && calificacion !== null && comentario !== null) {
                // Validar la calificaci√≥n
                if (calificacion >= 1 && calificacion <= 5) {
                    rese√±as[index] = {...rese√±a,
                        servicio,
                        calificacion: parseInt(calificacion),
                        comentario
                    };
                    localStorage.setItem('rese√±as', JSON.stringify(rese√±as));
                    mostrar(); // Actualizar la vista
                } else {
                    alert('Por favor ingresa una calificaci√≥n v√°lida (entre 1 y 5).');
                }
            }
        }

        // Funci√≥n para borrar una rese√±a
        function borrarRese√±a(index) {
            if (confirm('¬øEst√°s seguro de que deseas borrar esta rese√±a?')) {
                rese√±as.splice(index, 1); // Eliminar la rese√±a del array
                localStorage.setItem('rese√±as', JSON.stringify(rese√±as)); // Actualizar en localStorage
                mostrar(); // Actualizar la vista
            }
        }
    </script>
</body>

</html>